

%% MAIN 1:  Gaining and saving all GRIMM data 

clc 
clear all
close all 

addpath("../functions/")

%% P1 - Specifying Parametors  

% Put all data in one time table with the following headers - dateTime, pm1
%, pm2.5 pm10 

% dataFolderPre      = "/home/lhw150030/mintsData"
dataFolderPre   = "/media/teamlary/Team_Lary_2/air930/mintsData"
dataFolder      = dataFolderPre  +  "/reference"
% 
% dotMatsFolder   = dataFolderPre    +  "/dotMats";
% 


% grimmDotMats = dotMatsFolder +  "/reference/" + nodeID
% % grimmDotMats    = dotMatsFolder +  "/" + nodeID

deliverablesFolder = dataFolderPre + "/deliverables"

dtSteps = [seconds(10)]  ; 
dt = dtSteps(1)

startDate  = datetime(2019,02,12) ;
endDate    = datetime(2019,04,29);

%% Loading Grimm Data 
nodeID          = "GRIMM";
eval(strcat("load('",deliverablesFolder,"/mints_FW_node_1_2_data_from_",string(startDate),"_to_",string(endDate),"_in_",...
        strrep(string(dt)," ","_"),"_averaged_slices_for_Node_",nodeID,"')"))

%% Loading Node Data 
nodeID          = "001e06323a06";

eval(strcat("load('",deliverablesFolder,"/mints_FW_node_2_2_data_from_",string(startDate),"_to_",string(endDate),"_in_",...
        strrep(string(dt)," ","_"),"_averaged_slices_for_Node_",nodeID,"')"))
    
%% Syncronizing Data  

mintsAll =  rmmissing(synchronize(mints,mintsGrimm,'intersection'));
    
fileNameIn  = strcat("mints_FW_3_1_from_",string(startDate),"_to_",string(endDate),"_in_",strrep(string(dt)," ","_"),"_Slices_Node_",nodeID)
saveAllData(deliverablesFolder,fileNameIn)





eval(strcat("save('",deliverablesFolder,"/mints_FW_node_1_2_data_from_",string(startDate),"_to_",string(endDate),"_in_",...
       strrep(string(dt)," ","_"),"_averaged_slices_for_Node_",nodeID,"',",...
       "'mintsAll','dt','startDate','endDate','nodeID')"))

eval(strcat("load('",deliverablesFolder,"/mints_FW_node_1_2_data_from_",string(startDate),"_to_",string(endDate),"_in_",...
       strrep(string(dt)," ","_"),"_averaged_slices_for_Node_",nodeID))

